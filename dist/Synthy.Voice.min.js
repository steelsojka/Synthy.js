/**
 * Synthy.Voice.min.js v0.2.0
 *
 * A polyphonic customizable synthesizer
 * @author Steven Sojka - Monday, February 18, 2013
 *
 * MIT Licensed
 */
var Synthy=function(){Synthy.Voice=function(a,b,c){var d=a.noteNumber,f=a.velocity||127,e=this;this.timer=a.timer;this.osc=[];this.driveFx=[];this.envelope=new Synthy.Envelope(b.envelope,c);this.filter=new Synthy.Filter(b.filter,d,c);b.osc.forEach(function(a){var b=new Synthy.Osc(a,d,f,c),a=new Synthy.Drive({drive:a.driveAmount,mix:a.driveMix,type:a.driveType},c);e.osc.push(b);e.driveFx.push(a);e.on("kill",b.kill,b);b.output.connect(a.input);a.output.connect(e.filter.input)});this.filter.output.connect(this.envelope.input);
this.output=this.envelope.input};Synthy.Voice.prototype={trigger:function(a){null==a&&(a=0);for(var b=0,c=this.osc.length;b<c;b++)this.osc[b].trigger(a);this.filter.trigger(a);this.envelope.trigger(a)},release:function(a){var b=this.envelope.getReleaseTime(),c=a||0;this.envelope.release(a);this.filter.release(a);for(var a=0,d=this.osc.length;a<d;a++)this.osc[a].release(c+b);this.killTime=c+b;this.timer.callbackAtTime(this.killTime,this.destroy,this)},destroy:function(){this.emit("destroy");this.output.disconnect(0)},
kill:function(){this.timer.removeCallbackAtTime(this.destroy,this.killTime);this.emit("kill");this.output.disconnect(0)}};Synthy.Emitter.register(Synthy.Voice);return Synthy}(Synthy||{});
